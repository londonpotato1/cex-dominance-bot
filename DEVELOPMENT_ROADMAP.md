# CEX Dominance Bot 개발 로드맵

**작성일**: 2026-01-30
**현재 진행률**: Phase 7a 완료 (85%)

---

## 📊 전체 진행 현황

| Phase | 상태 | 완성도 | 우선순위 |
|-------|------|--------|----------|
| Phase 0-3 | ✅ 완료 | 100% | - |
| Phase 4 (UI) | 🟡 일부 | 70% | **HIGH** |
| Phase 5a | ✅ 완료 | 98% | - |
| Phase 5b | ✅ 완료 | 85% | - |
| Phase 6 | ✅ 완료 | 100% | - |
| Phase 7a | ✅ 완료 | 100% | - |
| **Phase 7b** | ⏳ 대기 | 0% | **MEDIUM** |
| **Phase 7c** | ⏳ 대기 | 0% | **LOW** |

---

## 🎯 남은 작업 (우선순위별)

### 🔴 HIGH Priority (1-2주 내)

#### 1. 텔레그램 알림 통합 ⭐⭐⭐
**예상 소요**: 2-3일
**의존성**: Phase 7a 완료 (✅)

**구현 항목**:
- [ ] TelegramAlert 클래스 구현
  - [ ] 기본 메시지 전송 (text, markdown)
  - [ ] 알림 레벨별 포맷 (low, medium, high, critical)
  - [ ] 이미지/차트 전송 지원
  - [ ] 인라인 키보드 (버튼) 지원
- [ ] MarketMonitor 통합
  - [ ] 상장 감지 알림
  - [ ] 이벤트 감지 알림 (WARNING/HALT/MIGRATION/DEPEG)
  - [ ] 전략 추천 알림
- [ ] 알림 필터링 설정
  - [ ] 심각도별 on/off
  - [ ] 거래소별 필터
  - [ ] 조용한 시간대 (Do Not Disturb)
- [ ] Rate limiting (스팸 방지)
  - [ ] 동일 키 중복 알림 방지 (5분 내)
  - [ ] 시간당 최대 알림 수 제한

**테스트**:
- [ ] `tests/test_telegram_alert.py` 작성
- [ ] 실제 텔레그램 봇 테스트 (testnet)

---

#### 2. Phase 4: 따리분석 대시보드 UI ⭐⭐⭐
**예상 소요**: 3-4일
**의존성**: 없음 (독립적)

**구현 항목**:
- [ ] UI 탭 구조 설계
  - [ ] "따리분석" 탭 추가 (기존 UI 확장)
  - [ ] 실시간 상장 이벤트 리스트
  - [ ] 이벤트별 전략 표시
- [ ] 데이터 바인딩
  - [ ] EventStrategyExecutor 히스토리 연동
  - [ ] 실시간 업데이트 (WebSocket or 폴링)
- [ ] 시각화
  - [ ] 프리미엄 차트 (Plotly)
  - [ ] 거래량 차트
  - [ ] 예상 수익률 표시
- [ ] 인터랙션
  - [ ] 이벤트 클릭 시 상세 정보
  - [ ] 전략 승인/거부 버튼 (수동 트레이딩)
  - [ ] 필터링 (거래소, 이벤트 타입)

**파일**:
- `ui/tabs/ttari_analysis.py` (신규)
- `ui/components/event_card.py` (신규)
- `ui/components/strategy_panel.py` (신규)

**테스트**:
- [ ] UI 수동 테스트 (실제 실행)
- [ ] 성능 테스트 (100+ 이벤트)

---

#### 3. 전체 테스트 실행 및 검증 ⭐⭐
**예상 소요**: 1일
**의존성**: Phase 7a 버그 수정 완료 (✅)

**구현 항목**:
- [ ] 전체 테스트 실행
  ```bash
  pytest tests/ -v --tb=short --cov=. --cov-report=html
  ```
- [ ] 통과율 목표: **96%+**
- [ ] 실패 케이스 분석 및 수정
  - [ ] `test_exclude_usdt_btc_eth` 수정 (회귀)
  - [ ] 기타 실패 케이스
- [ ] 커버리지 리포트 생성
- [ ] 테스트 문서화

**산출물**:
- `TEST_COVERAGE_REPORT.md`
- `htmlcov/` (커버리지 HTML)

---

### 🟡 MEDIUM Priority (2-4주 내)

#### 4. Phase 7b: 이벤트 히스토리 분석 ⭐
**예상 소요**: 2-3일
**의존성**: Phase 7a 완료 (✅), 텔레그램 알림 완료

**구현 항목**:
- [ ] 데이터베이스 스키마 확장
  ```sql
  CREATE TABLE event_strategies (
      id INTEGER PRIMARY KEY,
      timestamp TEXT,
      symbol TEXT,
      exchange TEXT,
      event_type TEXT,
      recommended_action TEXT,
      expected_roi REAL,
      actual_roi REAL,  -- 사후 추적
      confidence REAL,
      ...
  );
  ```
- [ ] 이벤트 추적 시스템
  - [ ] 전략 생성 시 DB 저장
  - [ ] 실제 가격 변동 추적 (1시간, 3시간, 24시간 후)
  - [ ] 예상 vs 실제 수익률 비교
- [ ] 패턴 분석 엔진
  - [ ] 출금 중단 시 평균 프리미엄 변화율
  - [ ] 거래 재개 후 평균 변동성
  - [ ] 마이그레이션 스왑 수익률 통계
  - [ ] 디페깅 회복 시간 분석
- [ ] 예측 모델 개선
  - [ ] expected_roi 동적 조정 (과거 데이터 기반)
  - [ ] confidence 재계산

**파일**:
- `analysis/event_history.py` (신규)
- `analysis/pattern_analyzer.py` (신규)
- `migrations/007_event_strategies.sql` (신규)

**테스트**:
- [ ] `tests/test_event_history.py`
- [ ] 최소 30일 데이터 수집 후 검증

---

#### 5. 로깅/모니터링 최종 점검 ⭐
**예상 소요**: 1-2일
**의존성**: 없음

**구현 항목**:
- [ ] 구조화된 로깅 검증
  - [ ] JSON 형식 로그 출력 확인
  - [ ] 로그 레벨 적절성 검토
  - [ ] 민감 정보 마스킹 확인
- [ ] API 메트릭 수집 검증
  - [ ] `gate.py`의 `_metrics` 동작 확인
  - [ ] `/health` 엔드포인트 테스트
  - [ ] 메트릭 출력 형식 검증
- [ ] 에러 추적
  - [ ] 예외 로깅 완전성 확인
  - [ ] 스택 트레이스 기록
  - [ ] Sentry 통합 (Optional)
- [ ] 로그 파일 로테이션
  - [ ] 일별 로그 파일 분리
  - [ ] 오래된 로그 자동 삭제 (30일)

**산출물**:
- `LOGGING_GUIDE.md`
- `logs/` 디렉토리 구조 정리

---

#### 6. 실전 배포 체크리스트 ⭐
**예상 소요**: 1일
**의존성**: 텔레그램 알림, 테스트 검증 완료

**구현 항목**:
- [ ] 환경 설정
  - [ ] `.env.example` 작성
  - [ ] API 키 암호화 스크립트 검증
  - [ ] Railway 환경변수 설정 가이드
- [ ] 프로덕션 설정
  - [ ] `config/config.prod.yaml` 작성
  - [ ] 레버리지 제한 확인
  - [ ] Rate limit 설정
- [ ] 데이터베이스 백업
  - [ ] 자동 백업 스크립트
  - [ ] Railway persistent storage 설정
- [ ] 배포 스크립트
  - [ ] `deploy.sh` 작성
  - [ ] Health check 엔드포인트
  - [ ] Graceful shutdown
- [ ] Smoke test
  - [ ] 배포 후 기본 동작 확인 스크립트
  - [ ] 텔레그램 알림 테스트
  - [ ] WS 연결 확인

**산출물**:
- `DEPLOYMENT_CHECKLIST.md`
- `scripts/deploy.sh`
- `scripts/backup.sh`

---

### 🟢 LOW Priority (선택적)

#### 7. Phase 7c: 멀티 이벤트 상관관계 분석
**예상 소요**: 2-3일
**의존성**: Phase 7b 완료

**구현 항목**:
- [ ] 크로스 거래소 이벤트 추적
  - [ ] 업비트 출금 중단 + 빗썸 정상 → 빗썸 프리미엄 상승 예측
  - [ ] 한 거래소 HALT → 다른 거래소 유동성 이동 감지
- [ ] 동시 다발 이벤트 분석
  - [ ] 여러 코인 동시 출금 중단 (네트워크 이슈)
  - [ ] 여러 거래소 동시 상장 (프로젝트 마케팅)
- [ ] 상관관계 매트릭스
  - [ ] 이벤트 조합별 수익률 통계
  - [ ] 신뢰도 높은 패턴 자동 감지

**파일**:
- `analysis/correlation_analyzer.py` (신규)

---

#### 8. 추가 데이터 수집기 (Phase 5b 확장)
**예상 소요**: 3-4일
**의존성**: 없음

**구현 항목**:
- [ ] DEX Monitor 구현
  - [ ] Uniswap/PancakeSwap 유동성 추적
  - [ ] DEX vs CEX 가격 차이 감지
- [ ] Hot Wallet Tracker 구현
  - [ ] 거래소 핫월렛 잔고 추적
  - [ ] 잔고 급감 → 출금 폭주 감지
- [ ] Withdrawal Tracker 구현
  - [ ] 출금 대기 시간 추적
  - [ ] 출금 제한 자동 감지

---

## 📅 추천 개발 순서

### Week 1-2: 핵심 기능 완성
```
Day 1-3:  텔레그램 알림 통합 ⭐⭐⭐
Day 4-7:  따리분석 대시보드 UI ⭐⭐⭐
Day 8:    전체 테스트 실행 및 검증 ⭐⭐
```

### Week 3-4: 안정화 및 배포 준비
```
Day 9-11: Phase 7b (이벤트 히스토리 분석) ⭐
Day 12:   로깅/모니터링 최종 점검 ⭐
Day 13:   실전 배포 체크리스트 ⭐
Day 14:   배포 및 Smoke test
```

### Week 5+ (Optional): 고급 기능
```
- Phase 7c: 멀티 이벤트 상관관계
- Phase 5b 확장: 추가 데이터 수집기
```

---

## 🎯 단계별 체크포인트

### Checkpoint 1: 알림 시스템 완성 (Day 3)
- ✅ 텔레그램 알림 동작
- ✅ 이벤트 감지 시 자동 알림 발송
- ✅ 알림 필터링 설정 가능

### Checkpoint 2: UI 완성 (Day 7)
- ✅ 따리분석 탭 표시
- ✅ 실시간 이벤트 리스트
- ✅ 전략 추천 표시

### Checkpoint 3: 테스트 통과 (Day 8)
- ✅ 96%+ 테스트 통과율
- ✅ 커버리지 리포트 생성
- ✅ 회귀 테스트 수정 완료

### Checkpoint 4: 배포 준비 (Day 13)
- ✅ 프로덕션 설정 완료
- ✅ 배포 체크리스트 작성
- ✅ 백업 스크립트 동작

### Checkpoint 5: 프로덕션 배포 (Day 14)
- ✅ Railway 배포 성공
- ✅ Smoke test 통과
- ✅ 실전 모니터링 시작

---

## 📈 예상 완성도

| 시점 | 완성도 | 비고 |
|------|--------|------|
| **현재** | 85% | Phase 7a 완료 |
| **+1주** | 92% | 텔레그램 + UI 완성 |
| **+2주** | **97%** | 배포 준비 완료 ✅ |
| **+3주** | 98% | Phase 7b 완료 |
| **+4주+** | 100% | Phase 7c + 추가 기능 |

---

## 🚀 즉시 시작 가능한 작업

### 지금 바로 시작할 수 있는 것 (의존성 없음):

1. **텔레그램 알림 통합** → 최우선 ⭐⭐⭐
   - 다른 기능과 독립적
   - 사용자 경험 크게 향상
   - 2-3일이면 완성

2. **따리분석 대시보드 UI** → 병행 가능 ⭐⭐⭐
   - 텔레그램 작업과 독립적
   - UI 전문가라면 더 빠름

3. **로깅/모니터링 점검** → 짬날 때 ⭐
   - 짧은 시간에 완료 가능
   - 배포 전 필수

---

## 💡 추천 액션

### 옵션 A: 빠른 배포 (2주)
```
텔레그램 알림 → 테스트 검증 → 배포
(UI는 배포 후 업데이트)
```

### 옵션 B: 완성도 우선 (3주)
```
텔레그램 알림 → UI 완성 → 테스트 검증 → Phase 7b → 배포
```

### 옵션 C: 단계별 진행 (지금 시작) ✅
```
1. 텔레그램 알림 (지금 시작!)
2. 병행: UI 작업
3. 테스트 검증
4. 배포 준비
```

---

**추천**: 옵션 C (단계별 진행)
- 텔레그램 알림부터 시작
- UI는 병행 작업 가능
- 2주 내 배포 준비 완료 가능

---

다음에 뭐 할까요? 🎯

1. **텔레그램 알림 구현** (최우선 ⭐⭐⭐)
2. **따리분석 UI 구현** (병행 가능 ⭐⭐⭐)
3. **Phase 7b 먼저** (데이터 수집 시작)
